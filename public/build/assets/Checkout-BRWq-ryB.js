import{b as u,q as $,t as z,v as B,w as E,k as e,u as k,m as T,x as O,y as P,z as V}from"./productsRTK-a63fa0hW.js";import{H as G,F as L}from"./Footer-D9FBcr4T.js";import{B as j}from"./button.esm-CyuHKLYo.js";import{s as F,u as q,a as M,b as U}from"./app-Bq6nXqsz.js";import{I as C}from"./InputError-D5Ibqstj.js";import{I as n}from"./inputtext.esm-_Cm40c9v.js";import{F as R,a as A,b as y,g as Y,c as H,D as I}from"./utils-D2bLMn8k.js";import{D as J}from"./dialog.esm-CAEc0H6d.js";import"./Dropdown-DftF5NWu.js";import"./transition-GLrNVLI4.js";/* empty css            */import"./csstransition.esm-fEuSsQyL.js";const Q=l=>{const[a]=u.useState(Number(localStorage.getItem("cartId"))),h=u.useRef(null),s=u.useRef(null),{data:c,refetch:o}=$(a,{refetchOnMountOrArgChange:!0}),[p]=z(),[i]=B(),[d]=E(),r=c==null?void 0:c.find(t=>t.id===l.item.id),b=async()=>{if(h.current&&!h.current.disabled){h.current.disabled=!0;try{await i({cartId:a,productId:r.id},r);const t={...r,quantity:r.quantity-1};await p({data:t,id:r.id}),await o()}catch(t){console.error(t)}finally{h.current.disabled=!1}}},f=async()=>{if(s.current&&!s.current.disabled){s.current.disabled=!0;try{r.pivot.quantity===1?await d({cartId:a,productId:r.id}):await d({cartId:a,productId:r.id});let t={...r,quantity:r.quantity+1};await p({data:t,id:t.id}),await o()}catch(t){console.error("Error while removing item from cart: ",t)}finally{s.current.disabled=!1}}},m=async()=>{try{for(let g=0;g<r.pivot.quantity;g++)await d({cartId:a,productId:r.id});let t={...r,quantity:r.quantity+r.pivot.quantity};await p({data:t,id:t.id}),await o()}catch(t){console.log("Error while removing item from cart: ",t)}};return e.jsxs("div",{className:"flex justify-between bg-white border-2 border-gray-200 rounded-lg py-2 my-2 pl-4",children:[e.jsxs("div",{className:"flex flex-column justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold underline",children:l.item.name}),e.jsxs("div",{children:[l.item.pivot.quantity,"x"]})]}),e.jsxs("div",{children:[(l.item.price*l.item.pivot.quantity).toFixed(2),"€"]})]}),l.finalize?null:e.jsxs("div",{className:"flex flex-column justify-between border-l-2 border-left-indigo-200 mr-2 py-1 px-2",children:[e.jsx(j,{onClick:m,className:" w-fit px-1",icon:"pi pi-trash"}),e.jsx(j,{onClick:f,icon:"pi pi-minus",className:" w-fit px-1",ref:s}),e.jsx(j,{onClick:()=>b(),disabled:!l.item.quantity,icon:"pi pi-plus",className:"w-fit px-1",ref:h})]})]},l.index)},Z=({cart:l})=>{const a=k(),h=()=>{a(F(2))};return e.jsx("div",{className:"w-3/6 h-3/5 flex fixed top-48",children:e.jsxs("div",{className:"flex flex-row-reverse border-2 border-gray-200 rounded shadow-2xl",children:[e.jsx("div",{className:"flex flex-column overflow-y-scroll no-scrollbar py-2 px-2",children:l==null?void 0:l.map((s,c)=>e.jsx(Q,{item:s},c))}),e.jsxs("div",{className:"flex flex-column justify-center",children:[e.jsx("p",{className:"block text-primary text-4xl font-bold text-center px-2",children:"Sure you want this?"}),e.jsx(j,{onClick:h,label:"Proceed ->",type:"button",className:"bg-gray-200 text-primary hover:bg-indigo-300 hover:text-white text-xl  mt-4 text-semibold mr-4 ml-4 border border-indigo-700 rounded"})]})]})})},K=({activeStep:l})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex border-2 bg-indigo-200 border-gray-200 rounded justify-center py-4",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:`${l===1?"bg-white text-indigo-200 border-white animate-bounce":"border-indigo-300 bg-indigo-200 text-indigo-300"} border-2 h-7 w-1 rounded-full mr-2 mt-2 text-center font-bold`,children:"1"}),e.jsx("div",{className:"text-center",children:"Review your Items"}),e.jsx("hr",{className:`${l!==1?"bg-indigo-300":"bg-white"}
                        w-48 h-1 -ml-4 mr-4 my-4 border-0 rounded md:my-10`})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:`${l===2?"bg-white text-indigo-200 border-white animate-bounce":"border-indigo-300 bg-indigo-200 text-indigo-300"} border-2 h-7 w-1 rounded-full mr-2 mt-2 text-center font-bold`,children:"2"}),e.jsx("div",{className:"text-center",children:"Shipping Information"}),e.jsx("hr",{className:`${l!==2&&l!==1?"bg-indigo-300":"bg-white"} w-48 h-1 -ml-4 mr-4 my-4 border-0 rounded md:my-10`})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:`${l===3?"bg-white text-indigo-200 border-white animate-bounce":"border-indigo-300 bg-indigo-200 text-indigo-300"} border-2 h-7 w-1 rounded-full mr-2 mt-2 text-center font-bold`,children:"3"}),e.jsx("div",{className:"text-center",children:"Billing Information"}),e.jsx("hr",{className:`${l!==4?"bg-white":"bg-indigo-300"} w-48 h-1 -ml-4 mr-4 my-4 border-0 rounded md:my-10`})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:`${l===4?"bg-white text-indigo-200 border-white animate-bounce":"border-indigo-300 bg-indigo-200 text-indigo-300"} border-2 h-7 w-2 rounded-full mr-2 mt-2 text-center font-bold`,children:"4"}),e.jsx("div",{className:"text-center",children:"Finalize your Purchase"})]})]})}),W=()=>{var d,r,b,f,m,t,g,w;const l=k(),[a,h]=u.useState(!1),{data:s}=q(localStorage.getItem("userId"),{refetchOnMountOrArgChange:!0}),c={first_name:((d=s==null?void 0:s.shipping_info)==null?void 0:d.first_name)||"",last_name:((r=s==null?void 0:s.shipping_info)==null?void 0:r.last_name)||"",email:((b=s==null?void 0:s.shipping_info)==null?void 0:b.email)||"",phone_number:((f=s==null?void 0:s.shipping_info)==null?void 0:f.phone_number)||"",street_and_number:((m=s==null?void 0:s.shipping_info)==null?void 0:m.street_and_number)||"",city:((t=s==null?void 0:s.shipping_info)==null?void 0:t.city)||"",postal_code:((g=s==null?void 0:s.shipping_info)==null?void 0:g.postal_code)||"",country:((w=s==null?void 0:s.shipping_info)==null?void 0:w.country)||""},[o,p]=u.useState(null),i=async(N,{setSubmitting:x})=>{var v;try{await T.put(`api/v1/customers/${localStorage.getItem("userId")}/shipping-info`,JSON.stringify(N),{headers:{"Content-Type":"application/json"},withCredentials:!0}),l(F(3))}catch(_){p(((v=_.response)==null?void 0:v.data.errors)||{}),console.error(_)}finally{x(!1)}};return e.jsx("div",{className:"h-full w-3/6 flex fixed top-48",children:e.jsx("div",{className:"flex border-2 border-gray-200 rounded shadow-2xl w-4/5",children:e.jsx("div",{className:"flex flex-grow py-2 mr-4 overflow-y-auto ml-4 no-scrollbar",style:{maxHeight:"500px"},children:e.jsx(R,{initialValues:c,onSubmit:i,enableReinitialize:!0,children:({isSubmitting:N})=>e.jsxs(A,{className:"flex flex-row",children:[e.jsx("div",{className:"flex flex-col w-full mr-4",children:Object.keys(c).map(x=>e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:x,className:"text-400",children:x.replace(/_/g," ").replace(/\b\w/g,v=>v.toUpperCase())}),e.jsx(y,{as:n,disabled:!a,id:x,name:x,className:"w-full rounded pl-[14px] h-8"}),e.jsx("div",{className:"text-center",children:e.jsx(C,{message:o==null?void 0:o[x]})})]},x))}),e.jsxs("div",{className:"flex flex-col justify-start",children:[e.jsxs("div",{className:"flex flex-row-reverse mb-48",children:[e.jsx(j,{onClick:()=>l(F(1)),className:"text-indigo-500 mb-2 pl-4",icon:"pi pi-arrow-circle-left",tooltip:"Go back"}),e.jsx("p",{className:"block text-primary text-4xl font-bold text-center",children:"Dis u?"})]}),e.jsx(j,{onClick:()=>h(!a),label:`${a?"Guess it's fixed":"Let me fix this"}`,type:"button",className:"bg-gray-200 text-primary hover:bg-indigo-300 hover:text-white text-xl text-semibold mb-2 border border-indigo-700 rounded"}),e.jsx(j,{type:"submit",label:"Next screen ->",disabled:N,className:"bg-gray-200 text-primary hover:bg-indigo-300 hover:text-white text-xl text-semibold border border-indigo-700 rounded mt-6"})]})]})})})})})},X=()=>{var f,m,t,g,w,N;const l=k(),[a,h]=u.useState(!1),{data:s}=M(localStorage.getItem("userId"),{refetchOnMountOrArgChange:!0}),c=["Visa","MasterCard","American Express","Discover","JCB"],o=Y(),p=H(),i={cardholder:((f=s==null?void 0:s.billing_info)==null?void 0:f.cardholder)||"",card_type:((m=s==null?void 0:s.billing_info)==null?void 0:m.card_type)||"",card_number:((t=s==null?void 0:s.billing_info)==null?void 0:t.card_number)||"",cvv:((g=s==null?void 0:s.billing_info)==null?void 0:g.cvv)||"",card_expiration_month:((w=s==null?void 0:s.billing_info)==null?void 0:w.card_expiration_date.split("/")[0])||"",card_expiration_year:`20${(N=s==null?void 0:s.billing_info)==null?void 0:N.card_expiration_date.split("/")[1]}`||""},[d,r]=u.useState(null),b=async(x,{setSubmitting:v})=>{var _;r(null);try{const S={...x,card_expiration_date:x.card_expiration_month&&x.card_expiration_year?`${x.card_expiration_month}/${x.card_expiration_year.replace("20","")}`:void 0};await T.put(`api/v1/customers/${localStorage.getItem("userId")}/billing-info`,JSON.stringify(S),{headers:{"Content-Type":"application/json"},withCredentials:!0}),l(F(4))}catch(S){r(((_=S.response)==null?void 0:_.data.errors)||{}),console.error(S)}finally{v(!1)}};return e.jsx("div",{className:"h-full w-3/6 flex fixed top-48",children:e.jsx("div",{className:"flex border-2 border-gray-200 rounded shadow-2xl w-4/5",children:e.jsx("div",{className:"flex flex-grow py-2 mr-4 overflow-y-auto ml-4 no-scrollbar",style:{maxHeight:"500px"},children:e.jsx(R,{initialValues:i,onSubmit:b,enableReinitialize:!0,children:({isSubmitting:x})=>e.jsxs(A,{className:"flex flex-row",children:[e.jsxs("div",{className:"flex flex-col w-full mr-4",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"cardholder",className:"text-400",children:"Cardholder"}),e.jsx(y,{as:n,disabled:!a,id:"cardholder",name:"cardholder",className:"w-full rounded pl-[14px] h-8"}),e.jsx(C,{message:d==null?void 0:d.cardholder})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"card_type",className:"text-400",children:"Card Type"}),e.jsx(y,{as:I,disabled:!a,id:"card_type",name:"card_type",options:c,placeholder:"Select Card type",className:"w-full rounded border-1 border-gray-600"}),e.jsx(C,{message:d==null?void 0:d.card_type})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"card_number",className:"text-400",children:"Card Number"}),e.jsx(y,{as:n,disabled:!a,id:"card_number",name:"card_number",className:"w-full rounded pl-[14px] h-8"}),e.jsx(C,{message:d==null?void 0:d.card_number})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"cvv",className:"text-400",children:"CVV"}),e.jsx(y,{as:n,disabled:!a,id:"cvv",name:"cvv",className:"w-full rounded pl-[14px] h-8"}),e.jsx(C,{message:d==null?void 0:d.cvv})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"card_expiration_month",className:"text-400",children:"Expiration Month"}),e.jsx(y,{as:I,disabled:!a,id:"card_expiration_month",name:"card_expiration_month",options:o,placeholder:"Month",className:"w-fit border-1 border-gray-600"})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"card_expiration_year",className:"text-400",children:"Expiration Year"}),e.jsx(y,{as:I,disabled:!a,id:"card_expiration_year",name:"card_expiration_year",options:p,placeholder:"Year",className:"w-fit border-1 border-gray-600"})]})]})]}),e.jsxs("div",{className:"flex flex-col justify-start",children:[e.jsxs("div",{className:"flex flex-row-reverse mb-48",children:[e.jsx(j,{onClick:()=>l(F(1)),className:"text-indigo-500 mb-2 pl-4",icon:"pi pi-arrow-circle-left",tooltip:"Go back"}),e.jsx("p",{className:"block text-primary text-4xl font-bold text-center",children:"Dis right?"})]}),e.jsx(j,{onClick:()=>h(!a),label:`${a?"Guess it's fixed":"Let me fix this"}`,type:"button",className:"bg-gray-200 text-primary hover:bg-indigo-300 hover:text-white text-xl text-semibold mb-2 border border-indigo-700 rounded"}),e.jsx(j,{type:"submit",label:"Next step ->",disabled:x,className:"bg-gray-200 text-primary hover:bg-indigo-300 hover:text-white text-xl text-semibold border border-indigo-700 rounded mt-6"})]})]})})})})})},D=({cart:l})=>{const{data:a,refetch:h,isLoading:s}=M(localStorage.getItem("userId")),{data:c,refetch:o,isLoading:p}=q(localStorage.getItem("userId")),[i,d]=u.useState(),[r,b]=u.useState();u.useEffect(()=>{h(),o(),s||d(a==null?void 0:a.billing_info),p||b(c.shipping_info)},[c,a]);const f=()=>{let m=0;for(let t=0;t<(l==null?void 0:l.length);t++)m+=parseFloat(l[t].price).toFixed(2)*l[t].pivot.quantity;return m||0};return e.jsxs("div",{className:"flex mt-48",children:[e.jsxs("form",{className:"ml-12",children:[e.jsx("p",{className:"text-center text-xl text-primary font-semibold",children:"Shipping Information"}),e.jsxs("div",{className:"w-80",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"first_name",className:"text-400",children:"First name"}),e.jsx(n,{disabled:!0,id:"first_name",type:"first_name",placeholder:"...",className:"w-full rounded pl-[14px]",value:r==null?void 0:r.first_name})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"last_name",className:"text-400",children:"Last name"}),e.jsx(n,{disabled:!0,type:"last_name",placeholder:"...",className:"w-full rounded pl-[14px]",value:r==null?void 0:r.last_name})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"email",className:"text-400",children:"Email"}),e.jsx(n,{disabled:!0,type:"email_address",placeholder:"...",className:"w-full rounded pl-[14px]",value:r==null?void 0:r.email})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"phone_number",className:"text-400",children:"Phone"}),e.jsx(n,{disabled:!0,type:"phone_number",placeholder:"...",className:"w-full rounded pl-[14px]",value:r==null?void 0:r.phone_number})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"street_and_number",className:"text-400",children:"Street and Number"}),e.jsx(n,{disabled:!0,type:"street_and_number",placeholder:"...",className:"w-full rounded pl-[14px]",value:r==null?void 0:r.street_and_number})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"city",className:"text-400",children:"City"}),e.jsx(n,{disabled:!0,type:"city",placeholder:"...",className:"w-full rounded pl-[14px]",value:r==null?void 0:r.city})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"postal_code",className:"text-400",children:"Postal code"}),e.jsx(n,{disabled:!0,type:"postal_code",placeholder:"...",className:"w-full rounded pl-[14px]",value:r==null?void 0:r.postal_code})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("label",{htmlFor:"country",className:"text-400",children:"Country"}),e.jsx(n,{disabled:!0,type:"country",placeholder:"...",className:"w-full rounded pl-[14px]",value:r==null?void 0:r.country})]})]})]}),e.jsx("div",{children:e.jsxs("form",{className:"ml-16",children:[e.jsxs("div",{className:"w-60",children:[e.jsx("p",{className:"text-center text-xl text-primary font-semibold",children:"Billing Information"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"cardholder",className:"text-400",children:"Cardholder"}),e.jsx(n,{disabled:!0,id:"cardholder",type:"cardholder",placeholder:"...",className:"w-full rounded pl-[14px]",value:i==null?void 0:i.cardholder})]}),e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex flex-row justify-content-middle align-items-center",children:[e.jsx("label",{htmlFor:"card_type",className:"text-400 w-6",children:"Card Type"}),e.jsx(n,{disabled:!0,type:"card_type",value:i==null?void 0:i.card_type,placeholder:"Select Card type",className:"w-10 h-8 text-center mt-2"})]})}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"card_number",className:"text-400",children:"Card number"}),e.jsx(n,{disabled:!0,type:"card_number",placeholder:"****-****-****-****",className:"w-full rounded pl-[14px]",value:i==null?void 0:i.card_number})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"cvv",className:"text-400",children:"CVV"}),e.jsx(n,{disabled:!0,type:"cvv",placeholder:"***",className:"w-full rounded pl-[14px]",value:i==null?void 0:i.cvv})]}),e.jsx("div",{className:"mb-2 mt-3",children:e.jsxs("div",{className:"flex flex-row justify-content-middle h-8 align-items-center",children:[e.jsx("label",{htmlFor:"card_expiration_date",className:"text-400 ",children:"Expiration Date"}),e.jsx(n,{disabled:!0,type:"expiration_month",value:i==null?void 0:i.card_expiration_date.split("/")[0],placeholder:"Month",className:"w-full rounded pl-[14px] ml-2"}),e.jsx(n,{disabled:!0,type:"expiration_year",value:`20${i==null?void 0:i.card_expiration_date.split("/")[1]}`,placeholder:"Year",className:"w-full rounded pl-[14px] ml-2"})]})})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex flex-column border-2 border-gray-300 shadow-2xl rounded overflow-y-scroll no-scrollbar h-48 mt-4 mr-4 pl-4 w-2/3 z-50",children:[e.jsx("p",{className:"text-left text-xl text-primary font-semibold",children:"Your stuff"}),l.map((m,t)=>e.jsxs("div",{className:"h-8",children:[e.jsxs("span",{children:[e.jsx("strong",{children:m.name})," -"," "]}),e.jsxs("span",{children:[m.price," - "]}),e.jsx("span",{children:e.jsxs("small",{children:[m.pivot.quantity,"x"]})}),e.jsx("hr",{})]}))]}),e.jsx("div",{className:"z-50 h-fit w-fit bg-white rounded mt-4 ml-10",children:e.jsxs("div",{className:"flex flex-column text-xl text-primary font-bold align-items-center w-fit h-fit p-2",children:["To pay:"," ",e.jsx("span",{className:"text-500 text-xs",children:"(with taxes)"}),e.jsxs("div",{className:"bg-white rounded px-4 py-1 mt-2 mx-2 border-2 border-gray-200",children:["Total: ",f().toFixed(2),"€"]})]})})]})]})})]})},xe=l=>{const{token:a}=O(),[h,s]=u.useState(!1);let c=P(U);const[o,p]=u.useState(1),[i,d]=u.useState(!1),{data:r}=$(Number(localStorage.getItem("cartId")));u.useEffect(()=>{V(a),typeof c=="number"&&p(c)},[r,c]);const b=()=>calcTaxesAndTotal(r),f=()=>{s("Redirecting to Dashboard page..."),setTimeout(()=>{window.location.replace("/dashboard")},5e3)},m=async()=>{try{axios.post(`api/v1/customers/${localStorage.getItem("userId")}/order`,{taxes:Number(b()[0].toFixed(2)),total:Number(b()[1].toFixed(2))},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},withCredentials:!0})}catch(t){console.error(t)}d(!0),f()};return e.jsxs(e.Fragment,{children:[e.jsxs(J,{className:"text-center",header:"Order successfully placed",visible:i,closable:!1,children:[e.jsx("hr",{}),e.jsx("p",{className:"m-0",children:h})]}),e.jsxs("div",{className:"fixed w-full",children:[e.jsx(G,{auth:l.auth}),e.jsx(K,{activeStep:o})]}),e.jsxs("div",{className:"px-8 h-screen border-t-2 bg-gradient-to-br from-white to-gray-300",children:[e.jsx("div",{children:e.jsx("div",{className:"flex flex-column justify-items-center",children:o===1?e.jsx(Z,{cart:r}):o===2?e.jsx(W,{}):o===3?e.jsx(X,{}):e.jsx(D,{cart:r})})}),e.jsxs("div",{className:"flex items-center justify-end fixed right-80 top-40",children:[e.jsx("div",{className:"bg-white p-4 my-6 rounded-lg shadow-2xl",children:o===1?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Free of charge: one never pays here."}),e.jsx("p",{className:"font-bold",children:"Not with money."})]}):o===2?e.jsx(e.Fragment,{children:e.jsxs("p",{children:["Please, ",e.jsx("strong",{children:"call me the devil."})]})}):o===3?e.jsx("div",{children:e.jsx("p",{children:"I was Zuckerberging people before Zuckerberg's balls dropped."})}):o===4?e.jsx(e.Fragment,{children:e.jsx(j,{onClick:()=>m(),label:"Click to order!",type:"button",className:" text-primary text-2xl text-semibold"})}):null}),e.jsx("div",{className:"w-3 overflow-hidden",children:e.jsx("div",{className:"h-4 bg-white rotate-45 transform origin-top-left rounded-sm"})})]}),e.jsx("img",{src:"/images/hero/lucius.png",alt:"hero-1",className:"ml-auto mr-16 mt-10 block h-4/5 fixed right-24 bottom-2 z-40"})]}),e.jsx(L,{})]})};export{xe as default};
